<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Results</title>
</head>
<body>
    <input type="text" id="search-box" placeholder="Search...">
    <ul id="results"></ul>

    <!-- Include the Lunr.js script -->
    {{ partial "lunr-script.html" . }}

    <script>
    // Fetch the search index JSON
    fetch('/index.json')
      .then(response => response.json())
      .then(data => {
        // Initialize Lunr.js
        const idx = lunr(function () {
          this.field('title')
          this.field('content')
          this.ref('permalink')

          data.forEach(doc => {
            this.add(doc)
          })
        })

        // Search event listener
        document.getElementById('search-box').addEventListener('input', function () {
          const query = this.value
          const results = idx.search(query)
          const resultsContainer = document.getElementById('results')
          resultsContainer.innerHTML = ''

          if (results.length > 0) {
            results.forEach(result => {
              const item = data.find(doc => doc.permalink === result.ref)
              const li = document.createElement('li')
              const a = document.createElement('a')
              a.href = item.permalink
              a.textContent = item.title
              li.appendChild(a)
              resultsContainer.appendChild(li)
            })
          } else {
            resultsContainer.innerHTML = '<li>No results found</li>'
          }
        })
      })
    </script>
</body>
</html>
